# 多线程下载功能说明

## 新增功能

添加了 `--workers` 参数支持多线程并发下载，大幅提升下载速度。

## 使用方法

### 单线程（默认）
```bash
python -m quant_strategy.tools.fetch_all_stocks --start 20250101 --end 20251231
```

### 4 线程并发（推荐）
```bash
python -m quant_strategy.tools.fetch_all_stocks --start 20250101 --end 20251231 --workers 4
```

### 8 线程并发（高速）
```bash
python -m quant_strategy.tools.fetch_all_stocks --start 20250101 --end 20251231 --workers 8
```

## 速度对比

| 线程数 | 预计速度 | 预计时间 (5000 只) |
|--------|----------|-------------------|
| 1 线程 | ~1 只/秒 | ~1.4 小时 |
| 4 线程 | ~4 只/秒 | ~20 分钟 |
| 8 线程 | ~8 只/秒 | ~10 分钟 |

## 注意事项

1. **Tushare 限流** - 建议不超过 8 个线程，避免触发 API 限流
2. **网络带宽** - 多线程会消耗更多带宽
3. **CPU 使用** - 每线程约占用 5% CPU

## 推荐配置

| 场景 | 推荐线程数 |
|------|-----------|
| 日常使用 | 4 线程 |
| 紧急下载 | 8 线程 |
| 后台运行 | 2 线程 |

## 修复内容

1. ✅ 只下载请求范围的数据（不是全部历史）
2. ✅ 支持多线程并发
3. ✅ 保持进度显示
4. ✅ 线程安全的日志输出
