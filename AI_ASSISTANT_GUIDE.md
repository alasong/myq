# AI 股票数据助手使用指南

## 🤖 功能介绍

AI 助手支持自然语言命令下载股票数据，无需记忆复杂参数。

---

## 🚀 快速开始

### 1. 启动 AI 助手

```bash
# 交互式模式
python -m quant_strategy.tools.ai_assistant

# 单次命令模式
python -m quant_strategy.tools.ai_assistant "下载 2025 年数据"
```

### 2. 设置 Token

```bash
# 方式 1: 环境变量（推荐）
set TUSHARE_TOKEN=your_token_here

# 方式 2: 命令行参数
python -m quant_strategy.tools.ai_assistant --token your_token_here
```

---

## 📋 支持的命令

### 1. 下载数据

| 命令 | 说明 |
|------|------|
| `下载 2025 年数据` | 下载 2025 年全年数据 |
| `下载 250101-251231 的股票` | 下载指定日期范围 |
| `获取 20240101 到 20241231 的数据` | 下载指定日期范围 |
| `下载茅台的数据` | 下载贵州茅台 2025 年数据 |
| `批量下载全部股票 4 线程` | 下载全部股票，4 线程并发 |
| `下载今年数据 8 线程` | 下载今年数据，8 线程 |

### 2. 查看状态

| 命令 | 说明 |
|------|------|
| `查看缓存状态` | 显示缓存统计信息 |
| `状态` | 显示缓存统计信息 |

### 3. 清理缓存

| 命令 | 说明 |
|------|------|
| `清理缓存` | 清理 30 天前的缓存 |
| `清除缓存` | 清理 30 天前的缓存 |

### 4. 更新数据

| 命令 | 说明 |
|------|------|
| `更新数据` | 更新最近 30 天数据 |
| `更新最近 30 天` | 更新最近 30 天数据 |

### 5. 帮助

| 命令 | 说明 |
|------|------|
| `帮助` | 显示使用帮助 |
| `help` | 显示使用帮助 |

---

## 💡 使用示例

### 示例 1: 下载 2025 年全部股票数据

```bash
python -m quant_strategy.tools.ai_assistant

> 下载 2025 年数据
```

**输出：**
```
收到命令：下载 2025 年数据
------------------------------------------------------------
解析结果：{'action': 'download', 'start_date': '20250101', 'end_date': '20251231', 'workers': 4}
------------------------------------------------------------
开始下载：20250101 - 20251231
并发线程：4
获取全部股票列表...
全部股票：5485 只
...
✅ 下载完成！
```

### 示例 2: 下载指定日期范围

```bash
> 下载 250101-251231 的股票 8 线程
```

**输出：**
```
开始下载：20250101 - 20251231
并发线程：8
...
```

### 示例 3: 下载单只股票

```bash
> 下载茅台的数据
```

**输出：**
```
指定股票：1 只
开始下载：600519.SH
...
```

### 示例 4: 查看缓存状态

```bash
> 查看缓存状态
```

**输出：**
```
📊 缓存状态
============================================================
总文件数：5012
缓存大小：681.05 MB
股票数量：5012
完整数据：5000
不完整：12

按类型:
  daily_full: 5012 个
============================================================
```

---

## 🔧 高级功能

### 1. 并发控制

```bash
# 1 线程（最慢，最稳定）
> 下载 2025 年数据 1 线程

# 4 线程（推荐）
> 下载 2025 年数据 4 线程

# 8 线程（最快，可能触发限流）
> 下载 2025 年数据 8 线程
```

### 2. 智能日期识别

```bash
# 今年
> 下载今年数据

# 去年
> 下载去年数据

# 指定年份
> 下载 2024 年数据

# 指定日期范围
> 下载 20240101-20240331 的数据
```

### 3. 股票识别

```bash
# 股票名
> 下载茅台的数据
> 下载平安银行的数据
> 下载万科的数据

# 股票代码
> 下载 600519.SH 的数据
> 下载 000001.SZ 的数据
```

---

## ⚙️ 配置选项

### 环境变量

| 变量名 | 说明 | 默认值 |
|--------|------|--------|
| `TUSHARE_TOKEN` | Tushare API Token | 无 |
| `DATA_SOURCE` | 数据源（auto/tushare） | auto |

### 命令行参数

| 参数 | 说明 |
|------|------|
| `--token` | Tushare Token |
| `command` | 自然语言命令（可选） |

---

## 📊 性能参考

| 股票数 | 线程数 | 预计时间 |
|--------|--------|----------|
| 5000 只 | 1 线程 | ~90 分钟 |
| 5000 只 | 4 线程 | ~25 分钟 |
| 5000 只 | 8 线程 | ~15 分钟 |

---

## ❓ 常见问题

### Q1: 如何退出 AI 助手？
**A:** 输入 `quit` 或按 `Ctrl+C`

### Q2: 下载中断了怎么办？
**A:** 重新运行命令，会自动跳过已下载的股票

### Q3: 如何查看下载进度？
**A:** AI 助手会每 10 只显示一次进度

### Q4: 支持哪些日期格式？
**A:** 
- `2025 年`
- `20250101-20251231`
- `250101-251231`
- `20250101 到 20251231`

### Q5: 如何批量下载？
**A:** 使用"全部"或"批量"关键词：
```bash
> 批量下载全部股票
```

---

## 📝 命令速查表

```bash
# 下载
下载 2025 年数据
下载 250101-251231 的股票
下载茅台的数据
批量下载全部股票 4 线程

# 查看
查看缓存状态
状态

# 清理
清理缓存
清除缓存

# 更新
更新数据
更新最近 30 天

# 帮助
帮助
help

# 退出
quit
exit
q
```

---

## 🎯 最佳实践

1. **首次使用**: 先下载全部历史数据
   ```bash
   > 下载 2024 年数据 4 线程
   ```

2. **日常更新**: 每天更新最新数据
   ```bash
   > 更新数据
   ```

3. **定期检查**: 查看缓存状态
   ```bash
   > 查看缓存状态
   ```

4. **清理空间**: 定期清理旧数据
   ```bash
   > 清理缓存
   ```

---

**文档版本**: 1.0  
**更新日期**: 2026-02-27
